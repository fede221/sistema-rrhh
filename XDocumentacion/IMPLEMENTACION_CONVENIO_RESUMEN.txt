ğŸ“‹ RESUMEN: IMPLEMENTACIÃ“N DE CAMPO "CONVENIO" EN USUARIOS

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… CAMBIOS REALIZADOS

1ï¸âƒ£ FRONTEND (frontend/src/pages/Usuarios/Usuarios.js)
   â”œâ”€ âœ… Columna "Convenio" en tabla DataGrid
   â”‚  â””â”€ Indicador visual: ğŸŸ¢ Verde (Dentro) / ğŸ”´ Rojo (Fuera)
   â”œâ”€ âœ… Campo select en Formulario de Crear Usuario
   â”‚  â””â”€ PosiciÃ³n: Entre fecha_nacimiento y password
   â”‚  â””â”€ Opciones: âœ… Dentro de Convenio / âŒ Fuera de Convenio
   â””â”€ âœ… Campo select en Formulario de Editar Usuario
      â””â”€ PosiciÃ³n: Entre Rol y Referente
      â””â”€ Opciones: âœ… Dentro de Convenio / âŒ Fuera de Convenio

2ï¸âƒ£ BACKEND (backend/controllers/usuariosController.js)
   â”œâ”€ âœ… listarUsuarios() - Incluye convenio en SELECT
   â”œâ”€ âœ… crearUsuario() - Acepta y almacena convenio
   â”‚  â””â”€ Default: 'dentro' si no se envÃ­a
   â””â”€ âœ… editarUsuario() - Acepta y actualiza convenio
      â””â”€ Default: 'dentro' si no se envÃ­a

3ï¸âƒ£ DATABASE SCRIPTS
   â”œâ”€ âœ… backend/scripts/add-convenio-column.sql
   â”‚  â””â”€ Sentencias SQL para migraciÃ³n manual
   â””â”€ âœ… backend/scripts/add-convenio-migration.js
      â””â”€ Script Node.js para migraciÃ³n automÃ¡tica

4ï¸âƒ£ DOCUMENTACIÃ“N
   â”œâ”€ âœ… MIGRACION_CONVENIO.md - GuÃ­a completa
   â”œâ”€ âœ… CAMBIOS_CONVENIO.md - Resumen de cambios
   â””â”€ âœ… ACTIVAR_CONVENIO.md - Paso a paso

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ PRÃ“XIMOS PASOS (TODO)

1. Aplicar migraciÃ³n a base de datos:
   cd backend
   node scripts/add-convenio-migration.js

2. Reiniciar backend:
   npm start

3. Probar en frontend:
   - Crear usuario con convenio
   - Editar usuario y cambiar convenio
   - Verificar columna en tabla

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ESTRUCTURA DE LA IMPLEMENTACIÃ“N

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BASE DE DATOS                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ tabla: usuarios                                          â”‚  â”‚
â”‚  â”‚ â”œâ”€ id INT PRIMARY KEY                                   â”‚  â”‚
â”‚  â”‚ â”œâ”€ legajo VARCHAR(20) UNIQUE                            â”‚  â”‚
â”‚  â”‚ â”œâ”€ dni VARCHAR(8) UNIQUE                                â”‚  â”‚
â”‚  â”‚ â”œâ”€ nombre VARCHAR(100)                                  â”‚  â”‚
â”‚  â”‚ â”œâ”€ apellido VARCHAR(100)                                â”‚  â”‚
â”‚  â”‚ â”œâ”€ correo VARCHAR(100) UNIQUE                           â”‚  â”‚
â”‚  â”‚ â”œâ”€ rol VARCHAR(50)                                      â”‚  â”‚
â”‚  â”‚ â”œâ”€ activo TINYINT(1)                                    â”‚  â”‚
â”‚  â”‚ â”œâ”€ referente_id INT                                     â”‚  â”‚
â”‚  â”‚ â””â”€ convenio VARCHAR(20) DEFAULT 'dentro' â† NUEVO        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“â†‘
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚    BACKEND API (Node.js)     â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ POST /api/usuarios           â”‚ â†’ Crea con convenio
              â”‚ GET /api/usuarios            â”‚ â†’ Retorna convenio
              â”‚ GET /api/usuarios/:id        â”‚ â†’ Retorna convenio
              â”‚ PUT /api/usuarios/:id        â”‚ â†’ Actualiza convenio
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“â†‘
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   FRONTEND (React/MUI)       â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ Usuarios.js                  â”‚
              â”‚ â”œâ”€ DataGrid Convenio Column  â”‚
              â”‚ â”œâ”€ Create Form Convenio      â”‚
              â”‚ â””â”€ Edit Form Convenio        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”„ FLUJO DE DATOS

A) CREAR USUARIO CON CONVENIO:

   Frontend                Backend                Database
   â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€â”€
   
   Usuario completa
   formulario con
   convenio: "fuera"
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ POST /api/usuarios
                           â”‚
                           â”œâ”€ Valida campos
                           â”œâ”€ Hash contraseÃ±a
                           â”œâ”€ Inserta en usuarios
                           â”‚  (legajo, dni, nombre, ..., convenio)
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ INSERT INTO usuarios
                                               (legajo, dni, ..., convenio)
                                               VALUES (..., 'fuera')

B) EDITAR USUARIO Y CAMBIAR CONVENIO:

   Frontend                Backend                Database
   â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€â”€
   
   Usuario selecciona
   nuevo valor
   convenio: "dentro"
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ PUT /api/usuarios/:id
                           â”‚
                           â”œâ”€ Valida permisos
                           â”œâ”€ Actualiza en usuarios
                           â”‚  (SET convenio = ?)
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ UPDATE usuarios
                                               SET convenio = 'dentro'
                                               WHERE id = ?

C) LISTAR USUARIOS:

   Frontend                Backend                Database
   â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€â”€
   
   Carga tabla de
   usuarios
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ GET /api/usuarios
                           â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ SELECT id, legajo, dni,
                                                   nombre, apellido,
                                                   correo, rol, convenio
                                               FROM usuarios
                                               â”‚
           â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€ Muestra tabla con columna convenio
           â”‚  - ğŸŸ¢ Verde para "dentro"
           â”‚  - ğŸ”´ Rojo para "fuera"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ VALORES PERMITIDOS

Convenio: VARCHAR(20)
â””â”€ "dentro"  â†’ Empleado dentro de convenio (valor por defecto)
â””â”€ "fuera"   â†’ Empleado fuera de convenio

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” VERIFICACIÃ“N

DespuÃ©s de aplicar migraciÃ³n, verificar:

1. Base de datos:
   DESCRIBE usuarios;
   â†“
   Debe mostrar: convenio VARCHAR(20) DEFAULT 'dentro'

2. API:
   GET http://localhost:3001/api/usuarios
   â†“
   Cada usuario debe tener: "convenio": "dentro" | "fuera"

3. Frontend:
   - Crear usuario: Campo convenio visible en formulario
   - Editar usuario: Campo convenio visible en formulario
   - Tabla usuarios: Columna convenio visible con indicadores

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ CARACTERÃSTICAS

âœ… Idempotente: Seguro ejecutar el script mÃºltiples veces
âœ… Backward compatible: Usuarios existentes tendrÃ¡n "dentro"
âœ… Optimizado: Ãndice creado para bÃºsquedas rÃ¡pidas
âœ… Validado: Fallback a "dentro" si no se envÃ­a valor
âœ… Visual: Indicadores de color en tabla DataGrid
âœ… Documentado: GuÃ­as completas incluidas

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ ARCHIVOS MODIFICADOS/CREADOS

Modificados:
â”œâ”€ frontend/src/pages/Usuarios/Usuarios.js (actualizado)
â””â”€ backend/controllers/usuariosController.js (actualizado)

Creados:
â”œâ”€ backend/scripts/add-convenio-column.sql (migraciÃ³n SQL)
â”œâ”€ backend/scripts/add-convenio-migration.js (script Node.js)
â”œâ”€ MIGRACION_CONVENIO.md (documentaciÃ³n completa)
â”œâ”€ CAMBIOS_CONVENIO.md (resumen de cambios)
â””â”€ ACTIVAR_CONVENIO.md (paso a paso)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ ESTADO: LISTO PARA ACTIVACIÃ“N

Todo estÃ¡ preparado. Solo necesitas:

1. Ejecutar: node scripts/add-convenio-migration.js
2. Reiniciar: npm start
3. Probar: Crear/editar usuario con convenio

Â¡ImplementaciÃ³n completada! ğŸ‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
